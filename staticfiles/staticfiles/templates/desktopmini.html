{% extends "base.html" %}
{% load static %}

{% block content %}

<div class="mt-5"id="content-wrapper">
    <div class="column">
        {% if product.featured_img %}
        <div id="img-container">
            <div id="lens"></div>
            <img id=featured src="{{product.imageUrl}}">
        </div>
        {% else %}
        <div id="img-container">
          <div id="lens"></div>
          <img id=featured src="{% static 'img/cameraplaceholder.jpg' %}">
        </div>
        {% endif %}
        <div id="slide-wrapper">
            <i id="slideLeft" class="arrow bi bi-arrow-left-circle" style="font-size: 1.5rem;"></i>
            <div id="slider">
                {% for image in product.productgallery_set.all %}

                <img class="thumbnail" src="{{image.imageUrl}}">

                {% endfor %}
            </div>
            <i id="slideRight" class="arrow bi bi-arrow-right-circle" style="font-size: 1.5rem;"></i>
        </div>
    </div>

    <div class="column mb-5 pb-5">
        <h1>{{product}}</h1>
        <hr>
        <h3>Starting from Â£{{product.price}}</h3>

        <p>{{product.description|linebreaks }}</p>
        <h4>Finish:</h4>
        <!-- <button class="btn btn-grad btn-lg" href="#" id="checkout-button" style="visibility:visible;">Purchase</button> -->
        <select id="mySelect" class="form-select mb-4" onchange="finishSelectFunction()"aria-label="selectedFinish" style="width: 50%;">
          <option value=""selected>--Select Finish--</option>
          <option value="silver">Clean Silver</option>
          <option value="black">Matte Black</option>
        </select>
        <a id="black" href="google.com" style="display: none;">black</a>
        <div id="silverConfig" style=" display: none;">
          <h4>Configuration:</h4>
          <select id="silverSelect"class="form-select mb-4" onchange="silverSelectFunction()" aria-label="finsh selct" style="width: 50%;">
            <option value=""selected>--Select Memory/Storage--</option>
            <option value="silver-8-256">8GB Memory / 256GB Storage</option>
            <option value="silver-16-512">16GB Memory / 512GB Storage</option>
          </select>
          <a class="btn btn-grad btn-lg" id="silver-8-256" href="https://buy.stripe.com/bIY8wH5ep31AbXq000" style="display: none;">Add to Checkout</a>
          <a class="btn btn-grad btn-lg" id="silver-16-512" href="https://buy.stripe.com/00g28jeOZ9pYf9C5kl" style="display: none;">Add to Checkout</a>
        </div>
        <div id="blackConfig" style=" display: none;">
          <h4>Configuration:</h4>
          <select id="blackSelect"class="form-select mb-4" onchange="blackSelectFunction()" aria-label="finsh selct" style="width: 50%;">
            <option value=""selected>--Select Memory/Storage--</option>
            <option value="black-8-256">8GB Memory / 256GB Storage</option>
            <option value="black-16-512">16GB Memory / 512GB Storage</option>
          </select>
          <a class="btn btn-grad btn-lg" id="black-8-256" href="https://buy.stripe.com/4gw6oz8qB6dM7Ha5km" style="display: none;">Add to Checkout</a>
          <a class="btn btn-grad btn-lg" id="black-16-512" href="https://buy.stripe.com/14kfZ922d59IbXqaEH" style="display: none;">Add to Checkout</a>
        </div>
        <a class="btn btn-grad btn-lg disabled" id="disabledbtn" href="" style="display: inline-block;" disabled>Add to Checkout</a>
        <small style="display: block; padding-top: 10px;">Quantity can be changed at checkout. Now viewable in Augmented Reality:</small>
        <small>
          <a href="{% static 'ar/model.usdz' %}" rel="ar">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="bi bi-badge-ar-fill" viewBox="0 0 16 16" style="color:#000000b5">
              <path d="m6.031 8.574-.734-2.426h-.052L4.51 8.574h1.52zm3.642-2.641v1.938h1.033c.66 0 1.068-.316 1.068-.95 0-.64-.422-.988-1.05-.988h-1.05z"/>
              <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm4.265 5.458h2.004L6.739 11H8L5.996 5.001H4.607L2.595 11h1.2l.47-1.542zM8.5 5v6h1.173V8.763h1.064L11.787 11h1.327L11.91 8.583C12.455 8.373 13 7.779 13 6.9c0-1.147-.773-1.9-2.105-1.9H8.5z"/>
            </svg>
          </a>
        </small>
    </div>
  </div>  
</div>

<div class="container col-xxl-8 px-4">
    <div class="row flex-lg-row align-items-center g-5">
      <div class="col-lg-6">
        <h1 class="display-5 fw-bold lh-1 mb-3">Specifications:</h1>

      </div>
      <table class="table table-hover table-responsive align-middle">
        <thead>
          <tr>
            <th scope="col">Feature</th>
            <th scope="col">Detail</th>
            <th scope="col"></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th scope="row">Finish</th>
            <td>{{product.finish}}</td>
          </tr>
          <tr>
            <th scope="row">CPU</th>
            <td>{{product.processor}}</td>
          </tr>
          <tr>
            <th scope="row">Storage</th>
            <td>{{product.storage}}</td>
          </tr>
          <tr>
            <th scope="row">Memory</th>
            <td>{{product.memory}}</td>
          </tr>
          <tr>
            <th scope="row">Video Support</th>
            <td>{{product.video_support|linebreaks }}</td>
          </tr>
          <tr>
            <th scope="row">Audio</th>
            <td>{{product.audio|linebreaks }}</td>
          </tr>
          <tr>
            <th scope="row">Connection</th>
            <td>{{product.connections|linebreaks }}</td>
          </tr>
          <tr>
            <th scope="row">Communications</th>
            <td>{{product.communications|linebreaks }}</td>
          </tr>
          <tr>
            <th scope="row">Height</th>
            <td>{{product.height}}</td>
          </tr>
          <tr>
            <th scope="row">Width</th>
            <td>{{product.width}}</td>
          </tr>
          <tr>
            <th scope="row">Depth</th>
            <td>{{product.depth}}</td>
          </tr>
          <tr>
            <th scope="row">Weight</th>
            <td>{{product.weight}}</td>
          </tr>
          <tr>
            <th scope="row">Warranty</th>
            <td>{{product.warranty|linebreaks }}</td>
          </tr>
          <tr>
            <th scope="row">In The Box</th>
            <td>{{product.in_the_box|linebreaks }}</td>
          </tr>
          <tr>
            <th scope="row">Operating System</th>
            <td>{{product.operating_system|linebreaks }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

<script type="text/javascript" src="{% static 'js/slider.js' %}" ></script>
<script type="text/javascript" src="{% static 'js/zoom.js' %}" ></script>

<script src="https://js.stripe.com/v3/"></script>

<script type="text/javascript">
  // Create an instance of the Stripe object with your publishable API key
  var stripe = Stripe("pk_test_51Ir0syGCqOfTY5QU1LtV6cLgZEMIm99WKC17hvQeo0UeCO2vVIBaAMnfYDIeUdc7ibRgMLDTajDPBTurY3SbhDWy00AvhquvqO");
  var checkoutButton = document.getElementById("checkout-button");
  checkoutButton.addEventListener("click", function () {
    fetch('/checkout/')
    .then(function (result) { return result.json() })
    .then(function (data) {
      var stripe = Stripe(data.stripe_public_key);

      stripe.redirectToCheckout({
        sessionId: data.checkout_session_id
      }).then(function (result) {
        // If redirectToCheckout fails due to a browser or network
        // error, you should display the localized error message to your
        // customer using error.message.
        if (result.error) {
          alert(result.error.message);
        }
      })
        .catch(function (error) {
          console.error("Error:", error);
        });
    })
  })
</script>

<script type="text/javascript" src="{% static 'js/inbuiltcheckout.js' %}" ></script>

{% endblock content %}